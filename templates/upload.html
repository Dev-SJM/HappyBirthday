<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/upload.css') }}">
</head>
<body>
  <!-- ì§„í–‰ ìƒí™© ë°” -->
  <div class="progress-bar">
    <div class="progress" id="progress"></div>
  </div>

  <!-- ëˆˆ íš¨ê³¼ -->
  <div class="snow" style="left: 10%;">â„</div>
  <div class="snow" style="left: 30%; animation-delay: -2s;">â„</div>
  <div class="snow" style="left: 50%; animation-delay: -4s;">â„</div>
  <div class="snow" style="left: 70%; animation-delay: -6s;">â„</div>
  <div class="snow" style="left: 90%; animation-delay: -8s;">â„</div>

  <!-- í•œ ì¤„ ë©”ì‹œì§€ í˜ì´ì§€ -->
  <div class="container page active" id="message-page">
    <h1>ğŸ ì€ë¹„ êµ¬ë‹˜ì„ í–¥í•œ ë©”ì‹œì§€ ğŸ</h1>
    <form>
      <div class="form-group">
        <label for="short-message">ì „í•˜ê³  ì‹¶ì€ í•œ ì¤„ ë©”ì‹œì§€<span class="required">*</span></label>
        <input type="text" 
            id="short-message" 
            placeholder="ë”°ëœ»í•œ ë§ˆìŒì„ ì „í•´ë³´ì„¸ìš”" 
            required
            autocomplete="off">
      </div>
      <div class="buttons">
        <button type="button" onclick="nextPage('letter-page')">ë‹¤ìŒ ë‹¨ê³„ â–¶</button>
      </div>
    </form>
  </div>

  <!-- í¸ì§€ í˜ì´ì§€ -->
  <div class="container page" id="letter-page">
    <h1>ğŸ ì€ë¹„ êµ¬ë‹˜ê»˜ ë“œë¦¬ëŠ” í¸ì§€ ğŸ</h1>
    <form>
      <div class="form-group">
        <label for="letter">ë§ˆìŒì„ ë‹´ì€ í¸ì§€<span class="required">*</span></label>
        <textarea id="letter" 
            placeholder="ì†Œì¤‘í•œ ë§ˆìŒì„ ë‹´ì•„ í¸ì§€ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”"
            required></textarea>
      </div>
      <div class="buttons">
        <button type="button" onclick="prevPage('message-page')">â—€ ì´ì „</button>
        <button type="button" onclick="nextPage('photo-page')">ë‹¤ìŒ â–¶</button>
      </div>
    </form>
  </div>

  <!-- ì‚¬ì§„ ì—…ë¡œë“œ í˜ì´ì§€ -->
  <div class="container page" id="photo-page">
    <h1>ğŸ ì€ë¹„ êµ¬ë‹˜ê³¼ì˜ ì¶”ì–µ ì‚¬ì§„ ğŸ</h1>
    <form id="final-form" onsubmit="return validateForm(event)">
      <div class="form-group">
        <label for="photo">ì¶”ì–µì´ ë‹´ê¸´ ì‚¬ì§„<span class="required">*</span></label>
        <input type="file" 
               id="photo" 
               accept="image/*" 
               capture="environment"
               onchange="previewImage(event)" 
               required>
        <div class="image-preview" id="preview">
          ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”
        </div>
      </div>

      <div class="form-group name-input">
        <label for="sender-name">ë³´ë‚´ëŠ” ì‚¬ëŒ<span class="required">*</span></label>
        <input type="text" 
               id="sender-name" 
               placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" 
               required
               autocomplete="off">
      </div>

      <div class="buttons">
        <button type="button" onclick="prevPage('letter-page')">â—€ ì´ì „</button>
        <button type="submit">ë³´ë‚´ê¸° âœ¨</button>
      </div>
    </form>
  </div>

  <script>
    let currentProgress = 33.33;
    document.getElementById('progress').style.width = `${currentProgress}%`;

    function nextPage(pageId) {
      document.querySelector('.page.active').classList.remove('active');
      document.getElementById(pageId).classList.add('active');
      
      currentProgress = pageId === 'letter-page' ? 66.66 : 100;
      document.getElementById('progress').style.width = `${currentProgress}%`;
      
      window.scrollTo(0, 0);
    }

    function prevPage(pageId) {
      document.querySelector('.page.active').classList.remove('active');
      document.getElementById(pageId).classList.add('active');
      
      currentProgress = pageId === 'message-page' ? 33.33 : 66.66;
      document.getElementById('progress').style.width = `${currentProgress}%`;
      
      window.scrollTo(0, 0);
    }

    function previewImage(event) {
      const preview = document.getElementById('preview');
      const file = event.target.files[0];
      
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          preview.innerHTML = `<img src="${e.target.result}" style="max-width: 100%; max-height: 200px; object-fit: contain;">`;
        }
        reader.readAsDataURL(file);
      }
    }

    function validateForm(event) {
      event.preventDefault();
      
      const senderName = document.getElementById('sender-name').value;
      const photo = document.getElementById('photo').value;
      
      if (!senderName || !photo) {
        alert('ëª¨ë“  í•„ìˆ˜ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return false;
      }
      
      alert('ë©”ì‹œì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ„');
      return false;
    }

    // iOSì—ì„œ ê°€ìƒ í‚¤ë³´ë“œ í‘œì‹œ ì‹œ ë·°í¬íŠ¸ ì¡°ì • ë°©ì§€
    const viewportMeta = document.createElement('meta');
    viewportMeta.name = 'viewport';
    viewportMeta.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0';
    document.getElementsByTagName('head')[0].appendChild(viewportMeta);
  </script>
</body>
</html>